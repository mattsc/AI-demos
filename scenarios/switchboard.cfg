#textdomain wesnoth-Grnk

#ifdef TEST
[test]
#else
[scenario]
#endif
    id=switchboard
    name=_"Switchboard"
    next_scenario=null

    map_data="{~add-ons/AI-demos/maps/switchboard.map}"

    {DEFAULT_SCHEDULE}
    turns=-1
    victory_when_enemies_defeated=no

    [story]
        [part]
            background=portraits/goblins/spearman.png
            story=_"<span font='16'>Hi, I'm Grnk the Frail. You may remember me from such instructional campaigns as ""Grnk the Mighty"" and ""Why You Shouldn't Attack Peasants When There's A Mad Goblin Around.""  Today I am going to show you some examples how the Wesnoth AI can be modified.

Note that some of these AIs have made it into Wesnoth mainline by now (or are about to be mainlined).  They remain in this campaign so that they are all collected in one place and to enable easy experimenting with them, but you might not need to include this add-on in order to have these AIs available to you.

If you have comments, problems, suggestions or requests for additional AI behaviors, please visit our thread on the <span color='#00A000'>Wesnoth forums: http://tinyurl.com/AI-mods</span>

Additional information is available under ""<span color='#00A000'>Practical Guide to Modifying AI Behavior</span>"" on the <span color='#00A000'>Wesnoth wiki</span>.</span>"
        [/part]
    [/story]

    [side]
        side=1
        controller=human
        id=Grnk
        name=_"Grnk the Frail"
        gender=male
        unrenamable=yes
        type=Grnk the Spearman
        max_moves=99

        team_name=Grnk
        user_team_name=_"Grnk"
        persistent=yes
        save_id=Grnk

        [modifications]
            {TRAIT_QUICK}
        [/modifications]

        village_gold=0
        {GOLD 24 22 19}
        income=-2  # No income whatsoever
    [/side]

    # The labels and signposts to go on to the next scenario
    [event]
        name=prestart

        {PLACE_IMAGE "scenery/signpost.png" 14 6}
        {SET_LABEL 14 6 _"Swamp Lurkers"}

        {PLACE_IMAGE "scenery/signpost.png" 12 9}
        {SET_LABEL 12 9 _"Animals"}

        {PLACE_IMAGE "scenery/signpost.png" 13 9}
        {SET_LABEL 13 9 _"Wolves"}

        {PLACE_IMAGE "scenery/signpost.png" 12 10}
        {SET_LABEL 12 10 _"Swarm"}

        {PLACE_IMAGE "scenery/signpost.png" 11 11}
        {SET_LABEL 11 11 _"Dragon"}

        {PLACE_IMAGE "scenery/signpost.png" 3 9}
        {SET_LABEL 3 9 _"Guardians"}

        {PLACE_IMAGE "scenery/signpost.png" 3 7}
        {SET_LABEL 3 7 _"Patrols"}

        {PLACE_IMAGE "scenery/signpost.png" 15 8}
        {SET_LABEL 15 8 _"Recruiting"}

        {PLACE_IMAGE "scenery/signpost.png" 8 10}
        {SET_LABEL 8 10 _"Protect the Wizard"}

        {PLACE_IMAGE "scenery/signpost.png" 7 11}
        {SET_LABEL 7 11 _"HttT: The Elves Besieged"}

        {PLACE_IMAGE "scenery/signpost.png" 7 5}
        {SET_LABEL 7 5 _"Messenger Escort"}

        {PLACE_IMAGE "scenery/signpost.png" 5 6}
        {SET_LABEL 5 6 _"Prune Cart"}

        {PLACE_IMAGE "scenery/signpost.png" 4 10}
        {SET_LABEL 4 10 _"MP rushes"}

        #{PLACE_IMAGE "scenery/signpost.png" 1 10}
        #{SET_LABEL 4 10 _"Formula AI Demo"}

        {PLACE_IMAGE "scenery/signpost.png" 12 5}
        {SET_LABEL 12 5 _"Bottleneck Defense"}

        {PLACE_IMAGE "scenery/signpost.png" 10 5}
        {SET_LABEL 10 5 _"Healers"}

        {VARIABLE scenario_name switchboard}

        # Menu items explaining the different scenarios
        [set_menu_item]
            id=m01_menu_bottleneck_defense
            description=_"Bottleneck Defense Micro AI demo (Lua AI)"
            image=units/human-loyalists/lieutenant.png~CROP(16,7,36,36)~SCALE(24,24)
            [filter_location]
                x,y=12,5
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Bottleneck Defense Micro AI Demo" _"In the Bottleneck Defense Micro AI scenario, a small group of human soldiers is instructed to hold a pass against a large horde of orcs.  You can either watch them fight it out against the standard RCA AI or take over the orc side.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m02_swamp_lurkers
            description=_"Swamp Lurker AI demo (WML, Formula AI & Lua AI)"
            image=lurker.png~CROP(24,24,24,24)
            [filter_location]
                x,y=14,6
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Swamp Lurker AI Demo" _"Swamp lurkers are dumb, impulse-driven creatures which can move across most terrain, but only stop on swamp.  They move individually without any strategy and always attack the weakest enemy within their reach.  If no enemy is in reach, the lurker does a random move instead.
This scenario features three lurker sides written in WML, Formula AI and Lua AI, respectively."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m03_guardians
            description=_"Guardian AI demo (Lua AI)"
            image=items/buckler.png~CROP(24,24,24,24)
            [filter_location]
                x,y=3,9
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Guardian AI Demo" _"In 'Guardians', several variations of the standard Wesnoth guardian are shown, including a ""coward"" unit that runs away from any approaching unit (an ""inverse guardian"", in a way).
Written in Formula and Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m04_patrol
            description=_"Patrol AI demo (Lua AI)"
            image=units/goblins/wolf-rider.png~CROP(22,11,42,42)~SCALE(24,24)
            [filter_location]
                x,y=3,7
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Patrol AI Demo" _"'Patrols' contains AI modifications for units following patrol routes.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m05_recruiting
            description=_"Recruiting Tests AI demo (Lua AI)"
            image=units/human-loyalists/lieutenant.png~CROP(16,7,36,36)~SCALE(24,24)
            [filter_location]
                x,y=15,8
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Recruiting Tests AI Demo" _"A simple scenario set up for the sole purpose of testing different recruiting patterns.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m05_protect
            description=_"Protect the Wizard AI demo (Lua AI)"
            image=units/human-magi/red-mage.png~CROP(22,12,24,24)
            [filter_location]
                x,y=8,10
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Protect the Wizard AI Demo" _"This scenario demonstrates one side protecting a wizard while moving him to a goal location.  At the same time, the other side is modified to do priority attacks on the wizard, even if a better target (by the default AI criteria) is available.  You can watch the two AIs fight it out, or take control of either side to explore how the opposing AI behaves.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m05a_protect
            description=_"HttT: The Elves Besieged AI demo (Lua AI)"
            image=units/human-magi/red-mage.png~CROP(22,12,24,24)
            [filter_location]
                x,y=7,11
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"HttT: The Elves Besieged AI Demo" _"This is a reenactment of scenario ""The Elves Besieged"" of the mainline campaign ""Heir to the Throne"", just that the AI is playing Konrad's side here.  The same algorithm as for scenario ""Protect the Wizard"" is used.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m06_messenger
            description=_"Messenger Escort AI demo (Lua AI)"
            image=units/human-loyalists/cavalryman.png~CROP(33,27,24,24)
            [filter_location]
                x,y=7,5
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Messenger Escort AI Demo" _"'Messenger Escort' has the AI actively protect a messenger while he makes his way to the edge of the map.  The escort will also try to open the path for the messenger if there are enemies in the way.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m07_cart
            description=_"Prune Cart AI demo (Lua AI)"
            image=ox_cart.png~CROP(6,9,48,48)~SCALE(24,24)
            [filter_location]
                x,y=5,6
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Prune Cart AI Demo" _"This scenario features an orcish horde protecting a cart with magical prunes from an undead army, while the cart (slowly) makes its way through a mountainous area.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m08_animals
            description=_"Animals AI demo (Lua AI)"
            image=animals/dog.png~CROP(33,28,24,24)
            [filter_location]
                x,y=12,9
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Animals AI Demo" _"This scenario demonstrates a number of different animals following customized AI behavior, including wolves hunting deer in packs; dogs herding sheep; bears, spiders, yetis, boar and rabbits wandering and hunting/avoiding each other.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m09_wolves
            description=_"Wolves AI demo (Lua AI)"
            image=units/monsters/wolf.png~CROP(40,29,24,24)
            [filter_location]
                x,y=13,9
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Wolves AI Demo" _"Another demonstration of wolves wandering and attacking in packs, with a different behavior from that in 'Animals'.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m10_swarm
            description=_"Swarm AI demo (Lua AI)"
            image=units/undead/bat-se-4.png~CROP(24,16,24,24)
            [filter_location]
                x,y=12,10
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Swarm AI Demo" _"This scenario features bats moving around semi-randomly in a swarm.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m11_dragon
            description=_"Dragon AI demo (Lua AI)"
            image=units/monsters/fire-dragon.png~CROP(102,60,48,48)~SCALE(24,24)
            [filter_location]
                x,y=11,11
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Dragon AI Demo" _"This scenario features a fire dragon displaying a hunt-and-rest behavior.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m12_rushes
            description=_"MP Rush AIs (Lua AI)"
            image=units/orcs/grunt.png~CROP(23,15,24,24)
            [filter_location]
                x,y=4,10
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"MP rush AIs" _"Story only scenario that explains how to use the multiplayer rush AIs.
Written in Lua AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m20_fai
            description=_"Formula AI demo"  # Not included yet
            image=units/elves-wood/avenger.png~CROP(25,11,24,24)
            [filter_location]
                x,y=1,10
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Formula AI Demo" _"This scenario contains a simple demonstration of setting up a full AI using Formula AI."}
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=m30_healer_support
            description=_"Healer support Micro AI"
            image=units/elves-wood/shaman.png~CROP(26,19,24,24)
            [filter_location]
                x,y=10,5
            [/filter_location]
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals switchboard}
            [/show_if]
            [command]
                {MESSAGE Grnk "" _"Healer Support Micro AI" _"This scenario contains a simple demonstration of setting up the Healer Support Micro AI, which uses the healers of a side to back up injured or threatened units rather than having them participate in combat under all circumstances."}
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=start

        {MESSAGE Grnk "" "" _"Move me to any of the signposts to go to an AI modification demonstration.

Information about each demonstration can be accessed by right-clicking on the respective signpost.

Note that many of these AIs are now implemented as Micro AIs that can be included in a scenario with a few simple lines of WML code, without requiring any AI coding at all.  Check out the Micro AIs page on the Wesnoth wiki for more information."}

        [objectives]
            [objective]
                description=_"Move Grnk to one of the signposts"
                condition=win
            [/objective]
            [note]
                description=_"Right-click on a signpost to get information about the scenario"
            [/note]
        [/objectives]
    [/event]

    # Events for going on to next scenarios, when Grnk goes to a signpost
    [event]
        name=moveto
        [filter]
            x,y=12,5
        [/filter]

        {VARIABLE scenario_name bottleneck-defense}
        [endlevel]
            result=victory
            next_scenario=bottleneck-defense
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=14,6
        [/filter]

        {VARIABLE scenario_name lurkers}
        [endlevel]
            result=victory
            next_scenario=lurkers
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=12,9
        [/filter]

        {VARIABLE scenario_name animals}
        [endlevel]
            result=victory
            next_scenario=animals
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=13,9
        [/filter]

        {VARIABLE scenario_name wolves}
        [endlevel]
            result=victory
            next_scenario=wolves
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=12,10
        [/filter]

        {VARIABLE scenario_name swarm}
        [endlevel]
            result=victory
            next_scenario=swarm
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=11,11
        [/filter]

        {VARIABLE scenario_name dragon}
        [endlevel]
            result=victory
            next_scenario=dragon
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=3,9
        [/filter]

        {VARIABLE scenario_name guardians}
        [endlevel]
            result=victory
            next_scenario=guardians
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=3,7
        [/filter]

        {VARIABLE scenario_name patrols}
        [endlevel]
            result=victory
            next_scenario=patrols
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=15,8
        [/filter]

        {VARIABLE scenario_name recruiting}
        [endlevel]
            result=victory
            next_scenario=recruiting
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=8,10
        [/filter]

        {VARIABLE scenario_name protect-unit}
        [endlevel]
            result=victory
            next_scenario=protect-unit
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=7,11
        [/filter]

        {VARIABLE scenario_name The_Elves_Besieged}
        [endlevel]
            result=victory
            next_scenario=The_Elves_Besieged
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=7,5
        [/filter]

        {VARIABLE scenario_name messenger-escort}
        [endlevel]
            result=victory
            next_scenario=messenger-escort
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=5,6
        [/filter]

        {VARIABLE scenario_name prune-cart}
        [endlevel]
            result=victory
            next_scenario=prune-cart
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=4,10
        [/filter]

        {VARIABLE scenario_name rushes}
        [endlevel]
            result=victory
            next_scenario=rushes
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto2
        [filter]
            x,y=1,10
        [/filter]

        {VARIABLE scenario_name fai-demo}
        [endlevel]
            result=victory
            next_scenario=fai-demo
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=10,5
        [/filter]

        {VARIABLE scenario_name healer_support}
        [endlevel]
            result=victory
            next_scenario=healer_support
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            x,y=9,1
        [/filter]

        {VARIABLE scenario_name test}
        [endlevel]
            result=victory
            next_scenario=test
            bonus=no
            carryover_percentage=0
            carryover_report=no
            linger_mode=no
            replay_save=no
        [/endlevel]
    [/event]
#ifdef TEST
[/test]
#else
[/scenario]
#endif

